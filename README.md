# MULTIDownload - 圖形化下載工具

這是一個基於強大開源專案 [yt-dlp](https://github.com/yt-dlp/yt-dlp) 與現代化介面庫 [CustomTkinter](https://github.com/TomSchimansky/CustomTkinter) 打造的桌面下載工具。

它旨在解決複雜的指令操作痛點，提供一個美觀、直覺且功能強大的圖形化介面，支援高畫質影片下載、會員限定內容存取、直播錄製以及多工排程處理。

---

## 核心特色

### 強大下載能力
- **支援多平台**：除 YouTube 外，亦支援 yt-dlp 所涵蓋的數千個影音網站。
- **高畫質支援**：最高支援 8K 解析度下載，並可自由選擇影片編碼 (H.264, AV1, VP9)。
- **相容模式 (H.264 + AAC)**：**新增** 專為車用音響與舊裝置設計的相容模式，一鍵鎖定標準 MP4 格式與 AAC 音訊，確保在任何裝置上皆可播放。
- **音訊強化**：
  - 支援 **Auto (Opus)** 與 **AAC** 雙模式選擇。
  - 可自訂位元率 (128k - 320k)，並提供智慧品質提示 (避免對低畫質來源進行無意義的升頻)。
- **字幕下載**：分析影片後自動列出所有可用字幕，支援多選並嵌入影片中，若無字幕會明確提示。

### 進階功能
- **會員/限制內容存取**：
    - **瀏覽器直讀**：內建 Chrome, Edge, Firefox 等瀏覽器 Cookie 讀取功能，無需手動匯出檔案。
    - **cookies.txt 支援**：亦支援載入 Netscape 格式的 Cookie 檔案。
- **直播錄製**：支援從現在開始錄製，或嘗試從直播開頭追溯下載 (Live from start)。
- **時間裁剪**：可指定「開始時間」與「結束時間」，僅下載影片的精華片段。
- **多工排程與詳情**：
    - **詳細任務資訊**：佇列與歷史紀錄中顯示詳細格式資訊 (例如 `mp4 (1080p) [H.264] + (192kbps) [AAC]`)。
    - **獨立執行**：支援勾選「獨立執行」讓特定任務跳過排程，立即在背景開始下載。

### 現代化體驗
- **智慧提示系統**：
    - 介面底部會根據您的設定 (H.264 勾選狀態、音訊編碼)，即時顯示格式相容性提示。
    - 若選擇了較高的位元率但來源不支援，會自動顯示警告。
- **外觀自訂**：內建深色 (Dark) 與淺色 (Light) 模式，可於設定分頁中切換 (自動重啟生效)。
- **核心熱更新**：內建自動更新檢測，一鍵下載最新版 yt-dlp 核心，無需重新下載整個軟體，即可對抗 YouTube 演算法更新。

---

## 安裝與使用

### 一般使用者 (推薦)
1. 下載最新發布的壓縮包 (ZIP)。
2. 解壓縮至任意資料夾。
3. 雙擊執行 `MULTIDownload.exe` 即可使用。
   * *軟體包內已附帶穩定版 FFmpeg，無需額外安裝。若需更新 FFmpeg，僅需下載新版 `ffmpeg.exe` 覆蓋即可。*

### 開發者 (Python 原始碼)
若您想自行修改程式碼或透過 Python 執行：

1. **安裝依賴套件 (推薦使用 uv)**：
   ```bash
   uv pip install yt-dlp customtkinter
   ```
   *(若使用 pip: `pip install yt-dlp customtkinter`)*

2. **準備 FFmpeg**：
   需安裝 FFmpeg 並設定環境變數，或將 `ffmpeg.exe` 與 `ffprobe.exe` 放置於專案根目錄。

3. **啟動程式**：
   ```bash
   uv run python main.py
   ```
   *(或使用 pip: `python main.py`)*

---

## 操作指南

### 步驟一：基本設定
1. 在 **[影片網址]** 欄位貼上連結。
2. 點擊 **[分析網址]** 按鈕。
   - 程式會抓取影片標題、封面以及可用的字幕列表。
   - 若影片無字幕，會在字幕區塊明確顯示「此影片未提供字幕」。
3. 設定 **[下載位置]** (預設為當前目錄)。

### 步驟二：選擇格式 
- 到 **[格式/畫質]** 分頁。
- **相容性優先 (推薦)**：
  - 勾選 **[H.264 (相容模式)]**。
  - 程式會自動鎖定音訊為 AAC，確保車機/電視能完美播放。
- **畫質優先**：
  - 取消勾選 H.264。
  - 影片解析度可選最高 (Best/4K/8K)，音訊建議選 Auto (Opus) 獲得最佳壓縮比。
- **音訊品質**：若來源只有 128k (如 YouTube)，建議選 **Best (來源預設)** 以節省空間。

### 步驟三：進階選項 (Cookie 設定)
若下載會員限定影片或遇到 403 錯誤，請至 **[進階選項]**：
- **推薦方法**：勾選您的瀏覽器 (如 Chrome / Edge)，程式會自動讀取登入資訊。
  - *注意：下載時建議關閉該瀏覽器以避免權限衝突。*
- **替代方法**：使用 `cookies.txt` 檔案匯入。
  - Chrome / Edge: [Get cookies.txt LOCALLY](https://chromewebstore.google.com/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc)
  - Firefox: [cookies.txt](https://addons.mozilla.org/en-US/firefox/addon/cookies-txt/)

### 步驟四：開始下載
- 回到下方控制列，點擊 **[開始下載]**。
- 若任務緊急，可勾選 **[獨立執行]**，該任務將不會進入排隊，而是直接開始。

---

## 常見問題 (FAQ)

**Q: 下載的影片在車上播放沒有聲音？**
A: 這通常是因為影片使用了 Opus 音訊編碼。請在格式設定中勾選 **「H.264 (相容模式)」**，或手動將音訊編碼設為 **AAC**，即可解決此問題。

**Q: 為什麼我選了 320kbps 音質，聽起來跟原本一樣？**
A: YouTube 等串流平台的原始音質通常只有 128kbps (AAC) 或 160kbps (Opus)。強制轉成 320kbps 雖然會顯示高數值，但無法憑空增加音質細節，建議選擇 "Best (來源預設)"。

**Q: 下載到一半出現 "WinError 32" 錯誤？**
A: 這通常是因為檔案被防毒軟體掃描或佔用。本程式已內建自動重試機制，通常等待幾秒後會自動解決。若持續失敗，請嘗試暫時關閉防毒軟體。

**Q: 如何下載會員限定影片？**
A: 請在瀏覽器上登入 YouTube 帳號，然後在程式的 [進階選項] 中勾選對應的瀏覽器 (例如 Chrome)。

**Q: 淺色模式下字體看不清楚？**
A: 請確認您已更新至最新版本，程式已針對標題與提示文字進行了深淺色模式的自動適配。

---

## License
本專案僅供學習與個人使用。使用時請務必遵守目標網站的服務條款與版權規範。
核心下載功能由 [yt-dlp](https://github.com/yt-dlp/yt-dlp) 提供。
