# MULTIDownload (2025/12/28)

MULTIDownload 是一款基於 [yt-dlp](https://github.com/yt-dlp/yt-dlp) 開發的現代化桌面下載工具，結合了 [CustomTkinter](https://github.com/TomSchimansky/CustomTkinter) 打造的美觀介面。專為解決複雜指令操作而生，提供從單曲到整張歌單的流暢下載體驗。

最新版本導入了 **智慧熱更新** 與 **核心自動管理** 技術，讓軟體維護變得前所未有的簡單。

---

## 🚀 核心特色

### 🔄 智慧核心管理 (Auto-Core)
- **自動安裝**：首次執行時若偵測不到 `yt-dlp` 核心，程式會自動引導您下載。
- **雙重來源保障**：安裝過程優先連接 **PyPI** (快速)，若失敗會自動切換至 **GitHub Releases** (備援)，確保下載 100% 成功。
- **視覺化進度**：詳細的進度彈窗，讓您清楚掌握下載狀態。
- **Hot-fix**：核心程式與主程式分離 (位於 `lib/` 目錄)，即使 YouTube 改版，您也能在設定頁面單獨更新核心，無需重新下載整套軟體。

### 📦 應用程式熱更新 (Hot-Update)
- **無痛升級**：支援透過 GitHub Release 直接推送更新。
- **全量更新**：採用 Onedir 架構，支援下載更新包 (.zip) 並自動執行全資料夾覆蓋更新，讓您隨時享有最新功能。

### 🎵 智慧歌單管理 
- **整張下載 / 單曲選取**：貼上播放清單網址後，程式會自動偵測並提示。
- **視覺化選單**：分析完成後按下「加入任務」，即彈出互動視窗，列出所有歌曲讓您勾選。
- **任務展開**：選取的歌曲會自動展開為個別任務加入「等待列表」。

### 📝 進階字幕系統 
- **多語系支援**：不只下載預設字幕，還能同時勾選多種語言（如繁中、英文、日文）。
- **智慧排序**：自動依據優先權（繁中 > 簡中 > 英文...）排序字幕軌道。
- **Embed Subs**：支援將字幕內嵌至 MP4 檔案中 (部分播放器支援切換) 或是單獨下載 `.srt` 檔。

### ⚡ 強大下載能力
- **高畫質支援**：最高支援 8K 解析度，支援 AV1 / VP9 / H.264 編碼切換。
- **車用相容模式**：一鍵勾選「H.264 (相容模式)」，鎖定 H264 視訊 + AAC 音訊，確保舊款車機與電視完美播放。
- **會員限定存取**：內建瀏覽器 Cookie 讀取 (Chrome/Edge/Firefox)，免匯出檔案即可下載會員影片。

---

## 🛠️ 安裝與使用

### 一般使用者 (推薦)
1. 下載最新發布的 **MULTIDownload.zip**。
2. 解壓縮至任意資料夾 (內含 FFmpeg，無需額外安裝)。
3. 雙擊 `MULTIDownload.exe` 即可使用。
4. **首次執行**：若程式提示缺少核心，請點擊「確定」，程式將自動為您下載安裝。

### 開發者 (Python 原始碼)
若您想自行修改程式碼或透過 Python 執行：

1. **安裝依賴套件**：
   ```bash
   pip install -r requirements.txt
   # 或手動安裝: pip install requests yt-dlp customtkinter pillow browser-cookie3
   ```

2. **準備 FFmpeg**：
   需安裝 FFmpeg 並設定環境變數，或將 `ffmpeg.exe` 與 `ffprobe.exe` 放置於專案根目錄。

3. **啟動程式**：
   ```bash
   python main.py
   ```

4. **打包成執行檔**：
   - **Onedir 模式 (推薦，支援熱更新)**:
     ```bash
     python build_onedir.py
     ```
     產物位於 `dist/MULTIDownload` 資料夾。

   - **Onefile 模式 (單一 EXE)**:
     ```bash
     python build_onefile.py
     ```

**專案結構說明：**
- `main.py`: 程式入口與核心邏輯，包含熱更新與核心安裝模組。
- `ui/`: 介面模組
  - `layout.py`: 通用 UI 佈局。
  - `tasks.py`: 任務列表與歷史紀錄 UI。
  - `tooltip.py`: 懸浮提示元件。
- `core.py`: yt-dlp 下載引擎封裝。
- `constants.py`: 全域常數與語言代碼表。
- `build_onedir.py`: PyInstaller 打包腳本。

---

## 📖 操作指南

### 步驟一：基本設定
1. 在 **[影片網址]** 欄位貼上連結。
2. 點擊 **[分析網址]** 按鈕。
   - 程式會抓取影片標題、封面以及可用的字幕列表。
   - **若是歌單**：分析後會提示您設定格式，接著請按「加入任務」來選歌。
3. 設定 **[下載位置]** (預設為當前目錄)。

### 步驟二：選擇格式 
- 到 **[格式/畫質]** 分頁。
- **相容性優先 (推薦)**：
  - 勾選 **[H.264 (相容模式)]**。
  - 程式會自動鎖定音訊為 AAC，確保車機/電視能完美播放。
- **畫質優先**：
  - 取消勾選 H.264。
  - 影片解析度可選最高 (Best/4K/8K)。

### 步驟三：開始下載
- **單曲**：點擊 **[加入任務]** 或 **[開始下載]**。
- **歌單**：點擊 **[加入任務]** -> 彈窗選歌 -> 確認 -> 前往 **[任務列表]** 頁籤 -> 按下 **[下載選取項目]**。

---

## ❓ 常見問題 (FAQ)

**Q: 按下「安裝核心」後會發生什麼？**
A: 程式會開啟一個進度視窗，自動連接 PyPI 下載最新版 yt-dlp。如果 PyPI 連線失敗，會自動切換到 GitHub 下載。安裝完成後，程式會自動建立 `lib` 資料夾並放入核心檔案。

**Q: 下載的影片在車上播放沒有聲音？**
A: 這通常是因為影片使用了 Opus 音訊編碼。請在格式設定中勾選 **「H.264 (相容模式)」**，即可解決此問題。

**Q: 如何下載會員/年齡限制影片？**
A: 請在瀏覽器上登入 YouTube 帳號，然後在程式的 [進階選項] 中勾選對應的瀏覽器 (例如 Chrome)。

---

## License
本專案僅供學習與個人使用。使用時請務必遵守目標網站的服務條款與版權規範。
核心下載功能由 [yt-dlp](https://github.com/yt-dlp/yt-dlp) 提供。
